<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Eike Luedeling, University of Bonn, Germany" />

<meta name="date" content="2021-10-14" />

<title>Producing hourly temperature records for agroclimatic analysis</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Producing hourly temperature records for agroclimatic analysis</h1>
<h4 class="author">Eike Luedeling, University of Bonn, Germany</h4>
<h4 class="date">2021-10-14</h4>



<div id="the-need-for-hourly-records" class="section level2">
<h2>The need for hourly records</h2>
<p>Many agroclimatic models operate on an hourly basis. For tracking the transition of temperate-zone fruit trees through the dormancy season, all major chill and heat models <span class="citation">(Anderson et al., 1986; Bennett, 1949; Erez et al., 1990; Richardson et al., 1974)</span> require such high-resolution information. There are some models that operate on daily data <span class="citation">(Crossa-Raynaud, 1955)</span>, but these are often just mechanisms that use proxy relationships to translate daily temperatures into what hourly-scale models would produce, if temperature data at such resolution were available. This is useful in many situations, but clearly sub-optimal, since the relationship between chill/heat and average daily temperatures (or daily extreme temperatures) varies substantially between locations. Some relationships of this nature are given in <span class="citation">Luedeling and Brown (2011)</span> (though these are for the ratios between chill metrics). As a consequence, computations based on hourly data are always more reliable.</p>
<p>Unfortunately, hourly temperature data are often not recorded in places, for which we would like to compute chill or heat accumulation. Even where records have been collected, they are often incomplete, which makes them difficult to deal with. <code>chillR</code> contains some functions that help in such situations. In this tutorial, we use the <code>KA_weather</code> and <code>Winters_hours_gaps</code> datasets included in <code>chillR</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(chillR)</span></code></pre></div>
<p>All computations should also work for different datasets, as long as they are formatted as required by <code>chillR</code>, i.e. with columns Year, Month, Day, Tmax, Tmin for daily data, or Year, Month, Day, Hour, Temp_gaps, Temp for hourly records.</p>
</div>
<div id="hourly-data-from-daily-temperature-extremes" class="section level2">
<h2>Hourly data from daily temperature extremes</h2>
<p>Hourly temperatures typically follow a daily temperature cycle, which can be described mathematically. This can be done in various ways that differ in accuracy and mathematical complexity. <code>chillR</code> implements equations provided by <span class="citation">Linvill (1990)</span>, which are based on a sine curve for daytime temperatures, with nighttime cooling represented by a logarithmic decay function. Differences in daylength between locations are accounted for by computing sunrise and sunset times based on geographic latitude, using equations given by <span class="citation">Spencer (1971)</span> and <span class="citation">Almorox et al. (2005)</span>. The results of the latter equations can be directly accessed via the <code>daylength</code> function, which requires only the latitude and the Julian date (day of the year) as inputs.</p>
<p>For example, daylength, sunrise and sunset for January 15th, for a location at latitude 50.4, can be computed by the following code:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">daylength</span>(<span class="at">latitude=</span><span class="fl">50.4</span>,<span class="at">JDay=</span><span class="dv">15</span>)</span></code></pre></div>
<pre><code>## $Sunrise
## [1] 7.766425
## 
## $Sunset
## [1] 16.23357
## 
## $Daylength
## [1] 8.467149</code></pre>
<p>Or for the whole year:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>all_daylengths<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="at">JDay=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>,<span class="fu">sapply</span>(<span class="fu">daylength</span>(<span class="at">latitude=</span><span class="fl">50.5</span>,<span class="at">JDay=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>),cbind))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(all_daylengths))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">JDay</th>
<th align="right">Sunrise</th>
<th align="right">Sunset</th>
<th align="right">Daylength</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">7.962814</td>
<td align="right">16.03719</td>
<td align="right">8.074373</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">7.954191</td>
<td align="right">16.04581</td>
<td align="right">8.091618</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">7.944763</td>
<td align="right">16.05524</td>
<td align="right">8.110474</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">7.934540</td>
<td align="right">16.06546</td>
<td align="right">8.130920</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">7.923534</td>
<td align="right">16.07647</td>
<td align="right">8.152932</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">7.911757</td>
<td align="right">16.08824</td>
<td align="right">8.176486</td>
</tr>
</tbody>
</table>
<p>The <code>stack_hourly_temps</code> applies these function, as well as those proposed by <span class="citation">Linvill (1990)</span> to a record of daily minimum and maximum temperatures. Before doing this, it is a good idea to apply the <code>make_all_day_table</code> function to ensure that no days are missing from the record (sometimes, missing data isn’t marked as <code>NA</code>, but represented by missing rows in a data.frame). The <code>stack_hourly_temps</code> requires information on the latitude:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>weather<span class="ot">&lt;-</span><span class="fu">make_all_day_table</span>(KA_weather)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>hourtemps<span class="ot">&lt;-</span><span class="fu">stack_hourly_temps</span>(weather, <span class="at">latitude=</span><span class="fl">50.4</span>)<span class="sc">$</span>hourtemps</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>hourtemps<span class="sc">$</span>DATE<span class="ot">&lt;-</span><span class="fu">ISOdate</span>(hourtemps<span class="sc">$</span>Year,hourtemps<span class="sc">$</span>Month,hourtemps<span class="sc">$</span>Day,hourtemps<span class="sc">$</span>Hour)</span></code></pre></div>
<p>This is what the resulting table looks like:</p>
<table>
<thead>
<tr class="header">
<th align="left">DATE</th>
<th align="right">Year</th>
<th align="right">Month</th>
<th align="right">Day</th>
<th align="right">Tmax</th>
<th align="right">Tmin</th>
<th align="right">JDay</th>
<th align="right">Hour</th>
<th align="right">Temp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1998-01-01 19:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.2</td>
<td align="right">5.1</td>
<td align="right">1</td>
<td align="right">19</td>
<td align="right">6.424223</td>
</tr>
<tr class="even">
<td align="left">1998-01-01 20:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.2</td>
<td align="right">5.1</td>
<td align="right">1</td>
<td align="right">20</td>
<td align="right">6.203183</td>
</tr>
<tr class="odd">
<td align="left">1998-01-01 21:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.2</td>
<td align="right">5.1</td>
<td align="right">1</td>
<td align="right">21</td>
<td align="right">6.022917</td>
</tr>
<tr class="even">
<td align="left">1998-01-01 22:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.2</td>
<td align="right">5.1</td>
<td align="right">1</td>
<td align="right">22</td>
<td align="right">5.870701</td>
</tr>
<tr class="odd">
<td align="left">1998-01-01 23:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.2</td>
<td align="right">5.1</td>
<td align="right">1</td>
<td align="right">23</td>
<td align="right">5.738969</td>
</tr>
<tr class="even">
<td align="left">1998-01-02 00:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9.1</td>
<td align="right">5.0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">5.579378</td>
</tr>
<tr class="odd">
<td align="left">1998-01-02 01:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9.1</td>
<td align="right">5.0</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">5.473582</td>
</tr>
<tr class="even">
<td align="left">1998-01-02 02:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9.1</td>
<td align="right">5.0</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">5.377922</td>
</tr>
<tr class="odd">
<td align="left">1998-01-02 03:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9.1</td>
<td align="right">5.0</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5.290624</td>
</tr>
<tr class="even">
<td align="left">1998-01-02 04:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9.1</td>
<td align="right">5.0</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5.210343</td>
</tr>
<tr class="odd">
<td align="left">1998-01-02 05:00:00</td>
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9.1</td>
<td align="right">5.0</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">5.136034</td>
</tr>
</tbody>
</table>
<p>And here is a plot of part of the data:</p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>This plot shows a smooth temperature curve, which can now be used for computing metrics that require such data (see below).</p>
</div>
<div id="patching-holes-in-daily-temperature-records" class="section level2">
<h2>Patching holes in daily temperature records</h2>
<p>Quite often, the procedure outlined above isn’t sufficent for producing a continuous record, because some daily data are missing. Let’s make such a dataset from the KA_weather data as an example:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>KA_weather_gaps<span class="ot">&lt;-</span>KA_weather[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>KA_weather_gaps[,<span class="st">&quot;Tmin_original&quot;</span>]<span class="ot">&lt;-</span>KA_weather_gaps[,<span class="st">&quot;Tmin&quot;</span>]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>KA_weather_gaps[,<span class="st">&quot;Tmax_original&quot;</span>]<span class="ot">&lt;-</span>KA_weather_gaps[,<span class="st">&quot;Tmax&quot;</span>]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>KA_weather_gaps<span class="sc">$</span>Tmin[<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">15</span>,<span class="dv">20</span><span class="sc">:</span><span class="dv">30</span>,<span class="dv">35</span><span class="sc">:</span><span class="dv">40</span>,<span class="dv">44</span><span class="sc">:</span><span class="dv">45</span>,<span class="dv">48</span>,<span class="dv">50</span><span class="sc">:</span><span class="dv">60</span>)]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>KA_weather_gaps<span class="sc">$</span>Tmax[<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">12</span><span class="sc">:</span><span class="dv">15</span>,<span class="dv">17</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">30</span><span class="sc">:</span><span class="dv">35</span>,<span class="dv">42</span><span class="sc">:</span><span class="dv">60</span>,<span class="dv">65</span><span class="sc">:</span><span class="dv">70</span>)]<span class="ot">&lt;-</span><span class="cn">NA</span></span></code></pre></div>
<p>In such cases, we have two options for fixing this situation:</p>
<ul>
<li>we can interpolate the gaps</li>
<li>we can use data from another weather station to fill the gaps</li>
</ul>
<p>The first option - interpolation - is implemented in the <code>fix_weather</code> function:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fixed<span class="ot">&lt;-</span><span class="fu">fix_weather</span>(KA_weather_gaps)</span></code></pre></div>
<p>This operation resulted in a continuous record of daily minimum and maximum temperatures, but the linearly interpolated values were not very accurate. This is shown in the figure below, where the thick blue and red lines are the actual Tmin and Tmax values and the black lines represent the interpolated values.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAbFBMVEUAAAAAADoAAGYAAP8AOpAAZmYAZrY6AAA6ADo6AGY6kNtmAABmADpmAGZmZgBmZjpmkJBmtv+QOgCQOjqQZgCQkGaQtpCQ2/+2ZgC225C2/9u2///bkDrb////AAD/tmb/25D//7b//9v///+HRAbSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAe+UlEQVR4nO2diZakuI6GqXZNVt+qvjO3c5bMmc4mF7//O04AXiSv8gZEoP+cqowIjBHwIcs2iEmyWA2ajjaAdd9igFhNYoBYTWKAWE1igFhNYoBYTWKAWE1igFhNYoBYTWKAWE1igFhNagLo89fP2//v0zT99lcne1h3pnaA3r7/vXz6s5dFrLtSM0AKnRUj1vXUDNDHjxWgd27Erin2QKwmNQJ0i5+nJ6nDadb11NqNvzH07eXWEWN+LqrR40AT64G0H0DJbbLuVAMAershsgXRkV4YA/RA6g/Q2y3++fy1RNEM0AXUHaCv55/r/7cuPAN0AXUHSE9gvH7/mwG6gAZ5oJtenxigC2hADKSw+fwVm49ngB5IQ3phWyP29cwAPb52HAfarX5WpeZ5Ll6HAWJpzdNUThADxNK6ATQxQKxqMUCsFs0MEKtFCz8MEKtaG0ClBDFALKWlE1bughgg1qa1E88AsWrFALGaxACxWjQzQKwWrexUEMQAsVZt6DBArEoxQKwWqZl4BohVJ0UOA8SqEwCojCAGiCUBOMUuiAFiScDNGQD6et6egI+ml2KATqczAfSm07pE87swQKfTiQAyDxbGM5QxQKfTiQACuVljORIZoNPJAlRKEHsgloSO53CAzIOpHAPdkc4EkEqzOU3RHK0M0Ol0KoCqtsk6VHcBEOdIPK8wQCUEcY5ElkR+p9AFcY5EFu68Hw0Q50i8Q0FoCtswzpHIcrxOmQviHImscwHEORLvUB5AdII4RyLLdTpFLogHElkMEKtRPkBkghggludzSlwQA8RigFiN8gEiE8QAtakmN/f55LqcgiiIAWrSPD8CQd59rAU3tjJATZofgiAfF3ojxgA1aX4IggL+hkwQA9Sk+SEICgFEDYMYoCppZuaHICgU8VDDIAaoRoaZ+SEICrJCdEEMUI00Mtvf3gDtjmPY2dBcEANUoRkCZP/0qr3mtV3NW6y1gwGq0HCAyt950rrF0AZJLogBKpcNexggBqhClwGIQhADVC4D0PzYAJFcEANUrBnJ/NKt+qr3vrVuMgpQzpIBj/UsT2W8P3CKO9t6GW7uG6A4JwQXNAagNTMQSDXVsf7DNT8kQKVLjIYApNB5zARTcAzx4QHKEzQEoI8fK0APmeJuHgzQfCaACC6IPVChEDRpgKqoqntzaZMyAKVtGQDQcgU9SR1O967/aDkA2R8D89k1BJ0LoLwLGtGNvzH07SWeIvGuAZqDAAVd0FxFEAOU170DBD4OA2hPgu4FoEdIcedCkweokIQVnp1d0L0AtFv9AwWJIAJUhsL26tLHBehd+ZDIECFNFwOoiIWHBugWHD9tn76eoxMVOkt04n09VIB6Ds/1EebBgSlYmAGy+vznX9FvQNG0QLn6XdUFoUMVNShk6vpT4T7MBwCUjNmzAf2AGOjr+SldgFZ/VQw6WHGDYgAVutENnf0Bql06Joh+z4RIpPqrQtDBmuNdSN/UmQHytPmWjx+xEUKi7hugMEJhgIILMlt4YIA+f22TW/pvrSgAVUWgo7UN8gUpSgJE34kDAMpEOTAFeWhXSgB61dxEZ7loogJ0utwX28EMIhQFqMgFqZO5O0CUxeo2AbdsAUCEV8nRRAboZB15eK26DPms1wIkzwmQdr0NABFeZknTPQNkvzmO6MEBUu6nESDrgUYDVNWFGS3v8EGEegO0137ntgVaVXeAat2xohjIjO+8jm7CqiLQ0Qpeq5qhJED+auH9Au3FngARCgSi+42pEoDUnargQ53oAJ3KBcWuVTNzEwYoPs0R3gT8u4NoAM1hgKYygPQ9Ym/RW8VoumOAIosCd6rMFQDN+wOUv3UETq60ArRMoqr7VVuUB2i+M4Ck7uWGguoCgEyXeT+AsluKATTXANRHNIDwh+OVuVY3JCxDGKDQPNm9AzTdC0AnISh3qJWlNiJK3Cw0FwA09gDQANLhXyNA7+2tV7J+oxlfvj222S4iQNIy1AWgsZcQ4e5ZDZBTfC4HaLkD6LWp+5WufzNL997tD3cH0CoQD+Hd0b+EIqP9Acq3lRAgUH6bF7wtCaxyHED++OFpAMpeq46lJqie/HBopgMU8VVdtNRMCLYUKq5hiqtzNWHqcDkAnYKgfHcXxG1Snx1njCgNkB1o2gMgbR4FIIQNMLYQoF7KAYSO2d0B5HpRMEI05wFyPkVcVQeZydE6gFZ+zgwQ+mmwPSQVAuRcBLYtMwuPB4hYdxQgWQgQ8ab6vCoBOpSk/PymNjuyD6B3HyhhtoG3FinYQ/Shphn4qSaAaI/1EFQIEI4fDhKlu5IEaJYIoWDnHvS91MCd9lcd90SbVAaQY6KdnD/Xg4W+98dDu8cR1AQQaNbsGCMBoHkgQPSx7hhAsgYgirYJs5ocifba1CVtBDouGiCJDFCwgQK/obbMWT8E0KAosAygOQJQpJY2gMxcfTS/SxIgW8qOosDYocm2erUBBMLmGYZD0U1sIcY4gMKnXggRLoy6AzOI0QYARLhzmgAQ6PuaQ34oQUUABZpba7z6a/cvtAkDkF2hxNhs+TA/0xQmyFsROyJPjRnKsndOZwFyDu6MEWqxrlb5ThgJIPNJ2oEYs58xgIpdEMHYGECTINQ9FqASD+RHAfMcuDS3Yx4OHHYSacjfsBPyGh5AsDHbhhk7AkS6R8PVOQC6xUDKBWVjoNBlGsDHlDyQIFLMCYKfgKs0P+gPqohBqBdAcx6gsI9aARKZyvX4Ty1An7+m73+/Jm9p1QleojfexwCawvSoorrE+QFSnynF9WcdVsPtzbUA5Y9SeHcWgHIuyACUqCc5DvTt5dYw9XkyFQcKbkQQWTVfZIiKAaLUiYris64BChQk2Zo2N9IHu9FTCtAcPBupe6J/rpFN1XNhqMF3BnbM0EiukvkQgmjjthUAOWNF9osLEJ0gPU2e2nCsBcv3wzBAshSgpYu1ANTjyVR7uOFYYW5dFSY1bL1GtGG3QoAkFaAyF5QFCE6OQq305FyQrr0SIO2BOjxYaCJONOBDusz3b8eKAKLXOgKg7fQmDI7xUwaQ/RoolI2B3hJzYdQcietBwXEPFSC13o7B9O4AaYJCizIGoH52oEw0wiYB5ERYxQBtfHx7SZSg5Uic7SCItY0M0Nrs7dgd2wEgNyIqBsge0RRAGX5oLqgFIIJIORJnEzbjY5itXR3ofZNxEzdWAVAMkhl2KQjVgkHJeY4N9MjEArmhAwESm7wK8HBDoKp0DJQXIUeijoThkSEe/QMAokxkrOWqAAr21RFA+UsLXI/JIb7EpeABJLY6HYLaAIq+hLBIkz39LkCEtddiprHfRdRNlfHjjTzWA6TvVwiaHPvdkQLIECS0RxOBTYFdCFSVCqKb+u+mfjsWDg6N+Rh0nUYPBJA/R482GQIouIHAwA4aqnG6d0FTNDkQoFBM5HbiSj1Qun9F0wQmawIACZEkaDbarS9PAuhmcDFA0uy1u2YEoPAWAk0sehZwogCkSIF/BY6JAtWNyROd04z9axQgEVvdALSTC6JsaTnStQDNEYBQIVjaM8+3zwYJxQDBpswbmz4FQODggCOiPgkiQLGJmP4ioSp0DFteOw0gr8lPm2cA8ifZYvYL80FYcFwX1AZQnyYM7YR3bBQ5ZwKI1IJNmwsqr50AELqzw2utgn1EfaK9cZtkL14q34NiaZHaWpUHagylZ/fQzOZZO1kE0E4ExQBCFlLuxgrXbuRukwZQsAEzv/tTD37ZZT9AtLzuCfwmXHvh17om7LXpGfnA7YaYHyFTAMmTAIRb2WqAwnOwYYACRaPtq50Uw5OfXuHtPjI4gOgCJNxVgOoA6ponGl+C+qzkAJJytzZsR4BMjWCOWZeRYYCijZKBx+nTe/sxIZezNWIYp4T1dQD1zRMNj4ooAmgkQfZE7QcQqERPTSBjfIBiDZitYnYHhbz98AYMhwP0+atjEyZR38KclIMBmu2sY+waRwBRbgc1a3nbCgC0yjCkCvjhUjLAn6kAudY7V0Zqv+p6YePe1kMByMRx4wiazdWbjKERQIJgS3h+0rZgHoZgilT31SBAmVk6tTiUYcyapDtdwlvdLl+atfDyc6V3ASclNZuhpWLE/sOJ26WbBkhUABQe4UoBZKekzDgTcEFuBO3VPTtTqxGAkperuk8o4ogKPdAf251Aw162AnaEBtAQgtTg214ASQiQ22KoVs1ShMalkQPaTnPoPMNdCQKUNFo1cWEfVQfQqJetiDKAjAvqTNB2nEkAaRNJjzRs+5QHSMA1NiS2awX4It3MAn50MOxboS+GkAOiAOR29IFKAHq1OzDohXPomiYANIggHDmMAAgXRADhanTbYRov0JxhfpK3FCYAylqtTIh0M+s8UJs6AiS3s92XIN3/mk0XJguQKAAIdRS2380ghgLI1gMBMvsJKJKwpJ4+981oAUjbGyboXEF0DUD9CdJhlQUoUAhHM7Qb0gUGyHNFdh4T/rJ9RR142EmEReFfJN0dqwLIWB9isxAg3Y8fEwOJFoC6EWTC8iEASbubQYCwD/EA0kW9PY5On6vykX3JzVRg8wNVFwL0+v3vt6dh7wtDB7QAoPJbAZPVQYDct/Qh8xyAst0w6HrcbpyuRUIERBQgv240m+4tju0L3QHJMG2lA4k/5fvyaPOYNxbWAaQJarAIVWaDcmciCWkfgKxjywAEzm3CBTUCFCpdflP9xz/+Wv/Viw6QiJXE9XUECPIjzXy2X04IRFAFQKI7QGYrURfk9QcI7a67Fad4+WM9S09sD4CKXFCvNmzCr7bAN9NA4XA4ARDCDACEPZg0tUgAA5plSAKEzmwYIHxnWapoQn75whhoGUF8/TmoCXMO6AFtGB7opQNkhmCC5fR+YZLSAAn7HbqgiN3YkcR78l0AwiuUduNfn5aeWNsdiSmA4l9TFXYCyPADp5qoAMk0QALuUBgggwEGKQ+Q28GOtmHNAPkrdB8H2pJPvae6+l0AQgv7tGGT/7BsKUCewUUAwabL+xPfQz3Y6FeE5I5cy7JOfGSN7o82rwCtTVz0MdbJ893KOAJA22/unE8XFzT5SWaiADlIoLbGK+hFTBGCKgHy+CkDKFRlQu4q3R9tXgBSxaJZWsOTxr5H9wFSE85uDZ0AWv+QAQImK4D8NgyB5gLk9RqqABL+/GmkH+bfvVgJEFynND9QNvpZAFIDjU7hCcujwwXGAwitjPe9w4wqzLynfwtctNg2CkDS6/RTABJepyzugPxDGXVBzQC563R/LozigYR7/jfLAgCZHxA76zKnDWsNgqaAA4rfcowBEjmADEFwgYwCpGIqtYeZsxxsOKNjiX0AAisNCKKXs/wkdTgdqR+OnAYDAmkOL2IHqGsbNoUcEBkg5SoKAMKL1TcfIPxzUHSAfB9WA5Cz0ojZ+BtD317ieca3+s3hQcKWwoBHF7Ur9GzDIvzEABLKohxAZp/2BohIRjVAdq1SgAiJxrOCAGF+BCwF2ZHSnA0IkAClm9ow+PgMFaDFMgJA1vYMQCIBkLsitsVfOhIgtJYoDaK7JRo3cUOQH7+jBbo8mqR+LijGT+xusmXTtlUlACTdHXSXS7Q/CKDMaT4UIL/RXpQeB6pONO7Uvx2kwFE1j0M5Dh5fzs0AgdITBChaCkht2iAUAUhUA7QRCiba4vsRBSixTnLd/FrIVQYKpMeBeiUaFzooxstAs+UDZD9Kvz9Z9ngGcDZT1AFFZI8gGpMSLkHY5MClEgNIuTjhLwgYE1xKQoOIWaLyWg/UIdG4Jcj+7kQ9ToTgnoC2MNrCYqMsagVww2BQKwVQ2NeiH+sAikBABihbKLQeCM+qYqBUonGCMEDbT27EvNmZPv5NLsjcHYH5id9wE/EVuG0tBEj2AYj+c0Wh1IrlABESjedlHIwaUQ7BsxVwmgB3eSeA4E+x4lFfgQt5F4AIfkFFQrV2ASi+UnrdvMRkRk6PfCojwY4qAK7tYANQT9Cs7/AjZspHMUwBQLiCYLXmMwRITJaAGoBIcFQDpAhaMQ8s3RmgeEF91sIRaJML0gBN2AFlABJmswFrHIBco8N7YH6dJlSrAGMYZwRItx7FAK1NWFtyDlt/8JhCCajA4maAJqIDktCI6HEXlqC40V61m+nOqNfJAVIElQP0voY/b21BUIGHS/KDjvJaMZ2glRY8zkxwQCI9u2kBSlnt1ms6cs60BgIoWlECoCwdDQCp5kMU31C2db+6dONJSp8J5yjRAdLxD0yAmwNIVgCUs0PoToQUcYCSJzpuTD6MbgFoI6gUoOHpXXwlz4NwjlI63RLQBgsaOsq2YPqcuLE7KgUAotghIqOm+PTXAZTHowkgZWKdBxr0YGG5HIJMVoQcR7oDRgRIU2z6HtFiZQCByMddQ+CIOlZbws9kGzFSVz+1/rJ2aQy0DiH2GUjsItjdBQ/wRrLSGekAugAgqXtK3QDSoY9eIbpGBqDEasU3ghSr8o7EqSW/QtdhAnyUtkZptS/phHQHzFKTD4FW/zOlkigITRAp/jGhj91CbPOVAGVczAEA9VHf+hFB5gHeNEKmA48Bim9DdZZkGiAJAcqYrWKfKoAELTxSBEUrZoA2QYK2xyhM+q4YErNO70oDSCiA1Ahx/LKmAmRHUGsAgo4lDYHwxpcS1dapEKCx+YHqhDy1iX9AomdfJj2wwSbfgk36Rspko0EBCA7A65GBQoBog4xmtCZc5ACAvp4bB6Ez9dcJEgSwicbSYAQaAZTYgJk2FMnIlAIQnr4BAEU3HwRIBBdFTA8XOSSI7vPO1M4CJxUOLocJQunhjOPJOSDrMpJdmw2ghD9xZ//IAAn0lTZTnylyiAdqu50+V3+tIEEABO9ZTNNFc9+YmGvB7FlP92wsQKGlk4uPZi3Xa8OnuhSgxGxHbt28CmOgj987pGkdEKRH/AJOqWRy5M7wNwNQvHJ3lj1hx1o0jEMAHzvnkQ66PYD0D6SxwAgohKFqgkoB+nG+IHpRLDQB6X0APqgABSDyGzniAIXoUWs0ApQ3KkxZF36Km7Cm1/Rk669XlCDdXOmOvQMKASDYgJHsCPAQw0dagpK1wn0TYDicBkG41BEAnTSIXpQgSN/5E3y1KAGgAn4MQPC3YNuF1snw4wMk7xSgswbRiyIEgVdMRLr0BID8alNWYB5y+JBqDQIkyAAFix0B0GmD6EWRpiYY+tileYDK5qwxQD3okSGA0P9l6yd/LFblZGoqiP56zpQZNVWyzTN4P+vb54NSixIAxUdyo0ZogDrh0wcgr9whHoigN52VI5qeYxxAYYKS2u5tTQKUi1AcI/QKveiRYYBgKFRWQeK3cnUHCIRJ0QRTLfWnhIaMiTIARZYn57ODNmxXe0d8nOlTGD/fH0DZ9C6goxZNcVdqJFWigqAMQFOhA5L6jo++uwlONhpDpDavoQ7GIQDl07sc6YG2EbyyU5cFqMwB6WG+zldJCCAwnkirABftMxBd0Y3PpXcx97vuHgPpSaiis5cGKDovkbBhhJMNACTLAPKK9uGnYiAxm94l+27wsQAJS1B+hC4D0FQLUMkKxEqF+7EIIL8ROwSgruldRkiYDhBtjiANkKmm1Iai8qQ6Q7eQiSkQ2aSq8O5r7GBZVQx0oqcyHAlL0NQDIJoXG68eADlh0DEA9UzvMkT6dAOC0ivMWv4i6v3xO0ighktI/bF4lgV8PQagHhoNkNBjiiJ2+uHPCX7OAxCOfMCPJRBgF8QABSWs4hEwck0xgNQUxgMBFBrQblYBQH3u5YjX30cWIN2MxcusXyIA6XVPDlCRcQwQRYCOKTIRKiBBUYC2EmcGqLTDxwDRBNqnsI8nAGQ7cWcGqLYSWe69YnpEgIDCUQJyLUGAJgjQeDPzQhMYrZW4n1tUBJCdDj3bTfVRBedWswBNZ3NABpym8w7pOwSg+/NAMjg7TwBIngygspugM5XIfi3YBQAKEISj4yA/tszjAtRs06ILAOQTZOFYviUAko8KUKd7OeQ1AJLu/LiFY/nmAQRGoB8WoF78PNxItKsNAIcgAkCanLPw0w8gAWrroCsAJCS+yUykATrTFJjVdu5bY1+NIQNEliYBEGSdy7rEAehUc6hAKzutJ76LH0O6DECgGUsCNAXTNp9AouQm+lQlkgEqkSXBEAQAWv4igJwyJ9J2B2vjid/I6TYIJC8FkOddgAuytk3+aufQevtYq+MQ201S/RzQtQBy4psAJOhlOztYV6DC+w8jlXRpCKGuBZBEt8l7kAg3TDqTROFD+tFa2htCqIsBJOFtii4l4MieFaAutfTk5xoACbhx+6ypuwjer34+gPqMaXZpCKEeHiCPBXCf630B1EV9GkKg6wEk7TUYBeiEMXQn9Q2A5ACAtsQL70ckmAorGCoHB3swQHvYdoB679kYgNa8HNHZ+6MBMjd4hAASwXVYMQ0BSKGzf3qXkEIAieCEFwNUoSEAffxYAYrl8DgBQHZACCxjgCp0DQ8k3B+cIUW1QAP0uDF0fw0AaIlRn6QOp3vXX64wQGhIUS2AAO1m3p1rRDf+xtC3Fz9B2fgciWFFAIJDimqB/oEBouvxx4GiALlPPgv9NDMDVKBRAKVeinAAQML5rgxBo2oGIA6BCnQBgLzeuv2KbmxAAO1n3Z3r2gD56Qa0djPu3sUA4c8MUKGuB5BggHrqAr0wJyjGXyIA7WfcvesKAMk0QAJ8ZoBKdXGAvATMDFChGCAn5RIDVKbLACTgF7AoCNB+pt29LgGQpAAkbF5osJyVEQNkbmPViSsYoBJdHSAv5xIDVCYGyE3axfwU6ToACfAZLuqf9e1SugZAgBq3iWKA2nRJgNASBqhJDJCJfRigGl0IIGE+4UUMUIsuApAliAHqq0sBJCQD1FtXAcgQFAOoa963C+kyAGmCfIBs5tIjzLp3DQDo6znzTrFjAFIE+TMVDFCL+gP0pp9I9R5N7VN/vRigAeoOELib/hzJFYAYoP4akFzBpJU6R3oXKAaouy7lgWTwsXf7HpwD7Ll7jYiBlAs6XQwU03Y3PQNUpQG9MP1254j/YYAeStcZB4qLAWoQA6SzKjBAVWKApFRvIOGZjBrtCNBRKe7yUgAdbcZdalCSzeRkBgP0QOrvgb6eo5NgXeofIAaoXkMmU5/Kt3msur8E6ToaEQO9T5GXZHSqv78YoGpxL2wRA1QtBmgRA1StK+RIJKj7e9guIwZoFQNUKwZoFQNUKwZoFc9k1IoB2sRJXSrFvTBWkxggVpMYIFaTGCBWkxggVpMYIFaTGCBWkw4BiPVAOgCgc+kEe3sCE5Ba7Tnb/ozVCfb2BCYgMUAlOsHensAEJAaoRCfY2xOYgMQAlegEe3sCE5AYoBKdYG9PYAISA1SiE+ztCUxAYoBKdIK9PYEJSAxQiU6wtycwAYkBKtEJ9vYEJiAxQKxDxQCxmsQAsZrEALGaxACxmsQAsZrEALGaxACxmsQAsZrEALGaxACxmsQAsZrEALGa9PAAvapHmmw24o8f6czEvfX1rF6m9h5/K9bueo294K1Ujw+Qd9IOAGiz4fU8AH38/h+5dwwQxQAN19fzv/3xcvv7+c9/Pw1Ab7/9b6ejcCWA3m4t2c8FoH/9mHp5cIK+np9el629f/+vxZbXrT39/OO/Yy+o2cWk7SUVH7//z3Ysqs25EEBv315u8Py8/VMfdtLtVL2v5PxcbHl92iz5/HWgO3q/GbAYcTsMN5iX11VUm3MdgD5/rW7gt782dt52u/xvAH3846/bNf5ys+Xzj5etEd3MOUjLQVkNUMfiZletOY8PkO6ELVfdeu62GGj7uofW9uK2/e9/K5jfp/WS3zcSg9qweb1dQuZYVJvz+ABpD/Su+/Mfv68k/b4jQPLt6daCrbbcArE1gD0SoDcztLEdBQYoIQuQdjkHeCD58Y//+8+XxZZ14x/HAqRe8vb564kBygvEQOoQmXZ/JwuW8/X1/K9bGHSz5X0Jvd6PbcL0tXMLo1VjtsRADFBYuBcmX5eDdvuQe1FeR60X/Ov0JLUH+vx16zgfCJA+JDd6zLFggGJyxoHWwHEZB9rv9K0ArcCqGOjby2tDm9EsO5D6eovG1LFggFg1ah+VZ4AuLQaI1SQGiHWwGCBWkxggVpMYIFaTGCBWkxggVpMYIFaTGCBWkxggVpMYIFaTGCBWkxggVpMYIFaTGCBWkxggVpMYIFaTGCBWkxggVpMYIFaTGCBWkxggVpMYIFaTGCBWkxigKr26qV8XvR+XsOU4MUBV2p64//jxBH47MuPPcWKAqqRzjcEkQwwQiywF0Jaqacu7+vFjmrbsGztmgD1eDFCVdNIYnHf1T5sK9jJigKqkAXr77S+Qd/VPmwr2WPN2FANUJQDQ8sfkXTWpYI80blcxQFWCTRjMu/ruvdrl0cUAVQkE0Sjv6n65X88iBqhKoBuP8q5eryvPAFVJDyT+1M5nzbv606aCPdrA3cQAVQlOZei8q9v7wFQq2MuIAWI1iQFiNYkBYjWJAWI1iQFiNYkBYjWJAWI1iQFiNYkBYjWJAWI1iQFiNYkBYjWJAWI1iQFiNYkBYjWJAWI1iQFiNYkBYjWJAWI1iQFiNYkBYjWJAWI1iQFiNen/AWyN5ddxSIa0AAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>For small gaps, such linear interpolation often produces accurate values, but when gaps are longer, deviation from actual values can be quite substantial.</p>
<p>Gaps in the record can also be patched with proxy data from other weather station in the area. In this, it is critical to ensure that the proxy station is situated in a location with reasonably similar weather. Filling in gaps with records from somewhere else can easily introduce a bias - a systematic difference between stations - that could lead to large errors. These issues are addressed by the <code>patch_daily_temperatures</code> function, which uses one or more daily temperature datasets to fill holes in patch records.</p>
<p><code>chillR</code> contains a function that can look through the ‘Global Summary of the Day’ database and identify stations based on their coordinates. <code>handle_gsod</code> can do most of this work. When supplied with the <code>action</code> parameter ‘list_stations,’ its output is a list of weather stations in the database that are close to the specified coordinates (in <code>c(longitude,latitude)</code> format).</p>
<p>To run the code below, remove the comment marks (#). Retrieving these records can sometimes take a bit of time (especially when loading many years). It also depends on internet connectivity, and on the host website still operating and using the same protocols as when the function was written.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stations&lt;-handle_gsod(action=&quot;list_stations&quot;,location=c(6.99,50.62),</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                      time_interval = c(1998,1998))</span></span></code></pre></div>
<p>This list contains a column <code>chillR_code</code> which can be passed to the same function, when specifying the <code>action</code> ‘download_weather.’ Applying the same function to the resulting file then returns a dataset that <code>chillR</code> functions can easily use. Note that many records in this particular database have lots of gaps themselves, so it is quite common that the closest station listed there isn’t the most useful one.</p>
<table>
<thead>
<tr class="header">
<th align="left">chillR_code</th>
<th align="left">STATION.NAME</th>
<th align="right">Lat</th>
<th align="right">Long</th>
<th align="right">distance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">105180_99999</td>
<td align="left">BONN-HARDTHOEHE</td>
<td align="right">50.700</td>
<td align="right">7.033</td>
<td align="right">9.40</td>
</tr>
<tr class="even">
<td align="left">105170_99999</td>
<td align="left">BONN/FRIESDORF(AUT)</td>
<td align="right">50.700</td>
<td align="right">7.150</td>
<td align="right">14.39</td>
</tr>
<tr class="odd">
<td align="left">105190_99999</td>
<td align="left">BONN-ROLEBER</td>
<td align="right">50.733</td>
<td align="right">7.200</td>
<td align="right">19.45</td>
</tr>
<tr class="even">
<td align="left">105130_99999</td>
<td align="left">KOLN BONN</td>
<td align="right">50.866</td>
<td align="right">7.143</td>
<td align="right">29.42</td>
</tr>
<tr class="odd">
<td align="left">105060_99999</td>
<td align="left">NUERBURG-BARWEILER</td>
<td align="right">50.367</td>
<td align="right">6.867</td>
<td align="right">29.47</td>
</tr>
<tr class="even">
<td align="left">105080_99999</td>
<td align="left">BLANKENHEIM</td>
<td align="right">50.450</td>
<td align="right">6.650</td>
<td align="right">30.64</td>
</tr>
<tr class="odd">
<td align="left">105100_99999</td>
<td align="left">NUERBURG</td>
<td align="right">50.333</td>
<td align="right">6.950</td>
<td align="right">32.05</td>
</tr>
<tr class="even">
<td align="left">105020_99999</td>
<td align="left">NORVENICH</td>
<td align="right">50.831</td>
<td align="right">6.658</td>
<td align="right">33.17</td>
</tr>
<tr class="odd">
<td align="left">105140_99999</td>
<td align="left">MENDIG</td>
<td align="right">50.366</td>
<td align="right">7.315</td>
<td align="right">36.47</td>
</tr>
<tr class="even">
<td align="left">105090_99999</td>
<td align="left">BUTZWEILERHOF(BAFB)</td>
<td align="right">50.983</td>
<td align="right">6.900</td>
<td align="right">40.88</td>
</tr>
</tbody>
</table>
<p>In this present example, which is set in Klein-Altendorf, the experimental station of the University of Bonn, Germany, only the forth-closest record (Cologne/Bonn Airport, about 30 km from the site) contained adequate data for the period of the weather record of interest. The following code accesses and processes the data for this station for the analysis. Again, uncomment the code below to actually run the functions.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># patch_weather&lt;-handle_gsod(action=&quot;download_weather&quot;,stations$chillR_code[4],</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                      time_interval = c(1998,1998))</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># patch_weather&lt;-handle_gsod(patch_weather)$weather</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Year</th>
<th align="right">Month</th>
<th align="right">Day</th>
<th align="right">Tmin</th>
<th align="right">Tmax</th>
<th align="right">Tmean</th>
<th align="right">Prec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4.222222</td>
<td align="right">8.722222</td>
<td align="right">6.055556</td>
<td align="right">4.572</td>
</tr>
<tr class="even">
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">4.222222</td>
<td align="right">9.888889</td>
<td align="right">7.777778</td>
<td align="right">0.254</td>
</tr>
<tr class="odd">
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4.277778</td>
<td align="right">10.888889</td>
<td align="right">7.888889</td>
<td align="right">3.048</td>
</tr>
<tr class="even">
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4.388889</td>
<td align="right">9.277778</td>
<td align="right">7.333333</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="right">1998</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">4.722222</td>
<td align="right">8.777778</td>
<td align="right">6.388889</td>
<td align="right">0.254</td>
</tr>
</tbody>
</table>
<p>Patching the gaps can then easily be done with the <code>patch_daily_temperatures</code>function.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>patched_weather<span class="ot">&lt;-</span><span class="fu">patch_daily_temperatures</span>(KA_weather_gaps,patch_weather)</span></code></pre></div>
<p>The resulting list contains two elements. Let’s first look at the second one, which is called <code>statistics</code>:</p>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mean_bias</th>
<th align="right">stdev_bias</th>
<th align="right">filled</th>
<th align="right">gaps_remain</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tmin</td>
<td align="right">0.317</td>
<td align="right">1.232</td>
<td align="right">43</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Tmax</td>
<td align="right">-1.001</td>
<td align="right">0.928</td>
<td align="right">47</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>This table contains information on the stations used for patching (only one in this case), the mean bias for Tmin and Tmax, and the bias in the standard deviation of both metrics between stations. The function automatically corrects for the mean bias, but not for the standard deviation one. The table also describes how many gaps were filled with this data, for Tmin and Tmax, respectively, and how many gaps remained. In this gaps, no gaps remained, but in other cases, it is possible to close remaining holes by adding more prpoxy stations or by using linear interpolation.</p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Even though the original dataset of 100 days was missing 43 minimum and 47 maximum temperatures, the gaps are now barely visible, with the patched datasets corresponding quite closely to actual temperatures. These can now be translated into hourly temperatures with the <code>stack_hourly_temps</code> function, as described above.</p>
</div>
<div id="interpolating-hourly-temperatures" class="section level2">
<h2>Interpolating hourly temperatures</h2>
<p>Sometimes we have actual records of hourly temperatures. While this is preferable, in principle, it may cause problems when the record isn’t complete. An example of such a record is the <code>Winters_hours_gaps</code> dataset contained in <code>chillR</code>. This is quite often the case, because temperature loggers can temporarily fail for many reasons. Gaps in such records are even harder to fill, because in this case, linear interpolation is usually not an option for gaps that span more than a couple of hours. Here’s an illustration of the error that may arise from this:</p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In this interpolation, some daytime or nighttime cycles were missed entirely, which can lead to substantial errors when calculating agroclimatic metrics, such as chill or heat stress that are of particular concern during the warmest and coolest parts of the day.</p>
<p><code>chillR</code>’s <code>interpolate_gaps_hourly</code> function provides an algorithm that can produce credible and continuous hourly records from such a patchy dataset. It combines several of the elements described above, but also adds functionality to derive daily temperature extremes from hourly data that were recorded. Without going into too much detail, here is the rough mode of operation:</p>
<ol style="list-style-type: decimal">
<li>Express temperatures for each hour as a function of daily temperature extremes using the functions of <span class="citation">Linvill (1990)</span>. According to this idealized curve, all hourly temperatures can be expressed as a function of Tmin and Tmax on the previous, same or next day of the temperature record (depending on which hour is of interest). For a day with a complete record, 24 equations can be set up.</li>
<li>For each daily temperature extreme, empirically solve the system of all equations that contain the respective Tmin or Tmax variable (this is only attempted, when a minimum of 5 equations are available, to avoid spurious results).</li>
<li>Close gaps in the resulting dataset of daily Tmin and Tmax using data from proxy stations or, as a last resort, linear interpolation.</li>
<li>Compute idealized temperature curves from the now continuous record of daily Tmin and Tmax values.</li>
<li>Calculate the difference between recorded temperatures and this idealized curve.</li>
<li>Linearly interpolate this difference and add this to the idealized temperature curve.</li>
</ol>
<p>The following code calls this function for the Winters dataset, using daily data from a nearby station of the California Irrigation Management Information System (CIMIS) as a proxy. This is retrieved with the <code>handle_cimis</code> function, which works similarly to the <code>handle_gsod</code> function described above. As before, uncomment the code to run the function (The CIMIS database seems to have occasional connectivity problems, and they’ve at least once made changes to their data storage system that required changes to the <code>handle_cimis</code> function. So it’s possible that the process times out or returns an error).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#stations&lt;-handle_cimis(&quot;list_stations&quot;,location=c(-122,38.5))</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#downloaded_winters&lt;-handle_cimis(&quot;download_weather&quot;,stations$chillR_code[2],</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#               time_interval = c(2008,2008))</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#winters_daily&lt;-handle_cimis(downloaded_winters)$weather</span></span></code></pre></div>
<p>Here’s what the dataset looks like:</p>
<table>
<thead>
<tr class="header">
<th align="right">Year</th>
<th align="right">Month</th>
<th align="right">Day</th>
<th align="right">Tmin</th>
<th align="right">Tmax</th>
<th align="right">Tmean</th>
<th align="right">Prec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2008</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">-1.7</td>
<td align="right">13.6</td>
<td align="right">5.0</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1.5</td>
<td align="right">12.2</td>
<td align="right">6.9</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">8.0</td>
<td align="right">11.0</td>
<td align="right">9.2</td>
<td align="right">132.8</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">5.3</td>
<td align="right">9.5</td>
<td align="right">7.2</td>
<td align="right">10.3</td>
</tr>
</tbody>
</table>
<p>And here is the call of the <code>interpolate_gaps_hourly</code> function:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>to_interp<span class="ot">&lt;-</span>Winters_hours_gaps</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>to_interp[,<span class="st">&quot;Temp_recorded&quot;</span>]<span class="ot">&lt;-</span>to_interp[,<span class="st">&quot;Temp&quot;</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>to_interp[,<span class="st">&quot;Temp&quot;</span>]<span class="ot">&lt;-</span>to_interp[,<span class="st">&quot;Temp_gaps&quot;</span>]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>interp<span class="ot">&lt;-</span><span class="fu">interpolate_gaps_hourly</span>(<span class="at">hourtemps=</span>to_interp,<span class="at">latitude=</span><span class="fl">38.5</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">daily_temps=</span><span class="fu">list</span>(<span class="at">Winters=</span>winters_daily))</span></code></pre></div>
<p>The resulting dataset has two elements: <code>$weather</code> and <code>daily_patch_report</code>. Let’s first look at the <code>daily_patch_report</code> element:</p>
<table>
<thead>
<tr class="header">
<th align="right">Var</th>
<th align="right">Proxy</th>
<th align="right">mean_bias</th>
<th align="right">stdev_bias</th>
<th align="right">filled</th>
<th align="right">gaps_remain</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Tmin</td>
<td align="right">solved</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">194</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="right">Tmin</td>
<td align="right">Winters</td>
<td align="right">-0.486</td>
<td align="right">2.097</td>
<td align="right">60</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">Tmin</td>
<td align="right">interpolated</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">Tmax</td>
<td align="right">solved</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">202</td>
<td align="right">52</td>
</tr>
<tr class="odd">
<td align="right">Tmax</td>
<td align="right">Winters</td>
<td align="right">-1.733</td>
<td align="right">2.374</td>
<td align="right">52</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">Tmax</td>
<td align="right">interpolated</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>This table contains information on how many gaps in the daily record were filled by solving the system of hourly equations (‘solved’), how many Tmin and Tmax values were derived from proxy stations (listed by name, if names were provided in the call to <code>interpolate_gaps_hourly</code>; otherwise as station_x), and how many were filled by linear interpolation (this option can be turned off using the <code>interpolate_remaining</code> parameter). For proxy stations, it also provides the bias in mean Tmin and Tmax, which has been corrected, as well as the bias in the standard deviation of Tmin and Tmax (which was <em>not</em> corrected).</p>
<p>The <code>$weather</code> element of the interpolation result contains the table of interpolated temperatures.</p>
<table>
<thead>
<tr class="header">
<th align="right">Year</th>
<th align="right">Month</th>
<th align="right">Day</th>
<th align="right">Hour</th>
<th align="right">Temp_gaps</th>
<th align="right">Temp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">15</td>
<td align="right">21.867</td>
<td align="right">21.867000</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">16</td>
<td align="right">21.604</td>
<td align="right">21.604000</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">17</td>
<td align="right">20.079</td>
<td align="right">20.079000</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">18</td>
<td align="right">17.344</td>
<td align="right">17.344000</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">19</td>
<td align="right">13.930</td>
<td align="right">13.930000</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">20</td>
<td align="right">11.929</td>
<td align="right">11.929000</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">21</td>
<td align="right">NA</td>
<td align="right">11.112486</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">22</td>
<td align="right">NA</td>
<td align="right">10.523274</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">23</td>
<td align="right">NA</td>
<td align="right">10.081787</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">9.795464</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">9.539421</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">9.342144</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">9.191565</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">NA</td>
<td align="right">9.078988</td>
</tr>
<tr class="odd">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">NA</td>
<td align="right">8.997942</td>
</tr>
<tr class="even">
<td align="right">2008</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="right">NA</td>
<td align="right">8.943478</td>
</tr>
</tbody>
</table>
<p>Here’s a plot of part of the data:</p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>This illustration shows that the <code>interpolate_gaps_hourly</code> function produced a pretty good approximation (red lines) to the actual temperatures (gray line).</p>
</div>
<div id="accuracy-assessment" class="section level2">
<h2>Accuracy assessment</h2>
<p>Since the actual hourly temperatures are known, we can evaluate the accuracy of the predictions produced by the various interpolation methods. A common measure for validating predictions is the Root Mean Square Error of the Prediction (RMSEP):</p>
<p><span class="math display">\[RMSEP=\sqrt{\frac{\sum_{i=1}^n(\hat{y}_i-y_i)^2}{n}}\]</span>, with <span class="math inline">\(\hat{y}_i\)</span> being the observed values and <span class="math inline">\(y_i\)</span> the predicted values.</p>
<p>The RMSEP provides an indication of how far each predicted value deviates, on average, from the actual values. It is, however, quite difficult to interpret RMSEP values alone, because whether they indicate a good or poor model fit depends on how variable the actual values are. For instance, an RMSEP of 5 days for a phenology model (which is close to, but not quite the same as a mean error of 5 days), could indicate a very good model, if observed dates vary by several weeks or months (e.g. for bloom dates of deciduous trees), but a terrible model, if the phenological stage of interest occurs on the same day every year (e.g. the ‘phenological’ event of candles lighting up on ‘festive indoor conifers’).</p>
<p>This is why it makes sense to include in such accuracy assessment the variation in observed values. This can be achieved by dividing the standard deviation of the observed data by the RMSEP to calculate the Residual Prediction Deviation (RPD):</p>
<p><span class="math display">\[RPD=\frac{sd_y}{RMSEP}\]</span> <span class="math inline">\(\hat{y}_i\)</span> are the observed values, <span class="math inline">\(y_i\)</span> the predicted values, and</p>
<p><span class="math display">\[sd_y=\sqrt{\frac{\sum_{i=1}^n(y_i-\bar{y})^2}{n-1}}\]</span></p>
<p>is the standard deviation, with <span class="math inline">\(\bar{y}\)</span> being the mean over all observations.</p>
<p>The RPD is more useful than the RMSEP, but its use of the standard deviation can be a problem, when actual values of <span class="math inline">\(y\)</span> aren’t normally distributed (then the standard deviation can be a poor measure of variation). A more robust approach is use the interquartile range instead of the standard deviation. This metric is called the Ratio of Performance to InterQuartile distance (RPIQ):</p>
<p><span class="math display">\[RPIQ=\frac{IQ}{RMSEP}\]</span></p>
<p>IQ is calculated by subtracting the 75<sup>th</sup> percentile of the distribution of all <span class="math inline">\(y\)</span> from the 25<sup>th</sup> percentile.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(stats)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>IQ<span class="ot">&lt;-</span><span class="fu">quantile</span>(y)[<span class="dv">4</span>]<span class="sc">-</span><span class="fu">quantile</span>(<span class="dv">2</span>)[<span class="dv">2</span>]</span></code></pre></div>
<p>The RPIQ score is a bit harder to evaluate than the RMSEP, with different quality thresholds in use and a very high context dependency. Quite commonly, values above 2 are considered ‘good’ or even ‘excellent,’ though some studies use substantially higher thresholds (up to 8 for excellence).</p>
<p>Since the RPIQ makes no assumption about the distribution of <span class="math inline">\(y\)</span>, let’s use this for assessing the accuracy of the various interpolation methods. We have a total of four methods to evaluate:</p>
<ul>
<li><strong>idealized</strong> temperature curves from <strong>daily</strong> records of Tmin and Tmax, based on records from a nearby weather station</li>
<li><strong>idealized</strong> temperature curves from <strong>daily</strong> records of Tmin and Tmax, based on records from <strong>the same location</strong><br />
</li>
<li><strong>linear</strong> interpolation of <strong>hourly</strong> temperatures</li>
<li>interpolation of <strong>hourly</strong> temperatures with <strong>interpolate_gaps_hourly</strong></li>
</ul>
<p>For option 2, we first have to generate a dataset of daily minimum and maximum temperatures from the hourly records. We can do this with the <code>make_all_day_table</code> function (see documentation for this function for details).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>orchard_extremes<span class="ot">&lt;-</span><span class="fu">make_all_day_table</span>(inter,<span class="at">timestep=</span><span class="st">&quot;day&quot;</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">input_timestep =</span> <span class="st">&quot;hour&quot;</span>)</span></code></pre></div>
<p>Let’s first look at the performance of the four methods for the periods that were missing in the hourly temperature record:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>winters_hours<span class="ot">&lt;-</span><span class="fu">stack_hourly_temps</span>(<span class="fu">fix_weather</span>(winters_daily),<span class="at">latitude=</span><span class="dv">38</span>)<span class="sc">$</span>hourtemps</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>start_hour_winters<span class="ot">&lt;-</span><span class="fu">which</span>(winters_hours<span class="sc">$</span>Year<span class="sc">==</span>inter<span class="sc">$</span>Year[<span class="dv">1</span>]<span class="sc">&amp;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                    winters_hours<span class="sc">$</span>Month<span class="sc">==</span>inter<span class="sc">$</span>Month[<span class="dv">1</span>]<span class="sc">&amp;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                    winters_hours<span class="sc">$</span>Day<span class="sc">==</span>inter<span class="sc">$</span>Day[<span class="dv">1</span>]<span class="sc">&amp;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                    winters_hours<span class="sc">$</span>Hour<span class="sc">==</span>inter<span class="sc">$</span>Hour[<span class="dv">1</span>])</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>end_hour_winters<span class="ot">&lt;-</span><span class="fu">which</span>(winters_hours<span class="sc">$</span>Year<span class="sc">==</span>inter<span class="sc">$</span>Year[<span class="fu">nrow</span>(inter)]<span class="sc">&amp;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                    winters_hours<span class="sc">$</span>Month<span class="sc">==</span>inter<span class="sc">$</span>Month[<span class="fu">nrow</span>(inter)]<span class="sc">&amp;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                    winters_hours<span class="sc">$</span>Day<span class="sc">==</span>inter<span class="sc">$</span>Day[<span class="fu">nrow</span>(inter)]<span class="sc">&amp;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                    winters_hours<span class="sc">$</span>Hour<span class="sc">==</span>inter<span class="sc">$</span>Hour[<span class="fu">nrow</span>(inter)])</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>orchard_hours<span class="ot">&lt;-</span><span class="fu">stack_hourly_temps</span>(orchard_extremes,<span class="at">latitude=</span><span class="dv">38</span>)<span class="sc">$</span>hourtemps</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>start_hour_orchard<span class="ot">&lt;-</span><span class="fu">which</span>(orchard_hours<span class="sc">$</span>Year<span class="sc">==</span>inter<span class="sc">$</span>Year[<span class="dv">1</span>]<span class="sc">&amp;</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                    orchard_hours<span class="sc">$</span>Month<span class="sc">==</span>inter<span class="sc">$</span>Month[<span class="dv">1</span>]<span class="sc">&amp;</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                    orchard_hours<span class="sc">$</span>Day<span class="sc">==</span>inter<span class="sc">$</span>Day[<span class="dv">1</span>]<span class="sc">&amp;</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                    orchard_hours<span class="sc">$</span>Hour<span class="sc">==</span>inter<span class="sc">$</span>Hour[<span class="dv">1</span>])</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>end_hour_orchard<span class="ot">&lt;-</span><span class="fu">which</span>(orchard_hours<span class="sc">$</span>Year<span class="sc">==</span>inter<span class="sc">$</span>Year[<span class="fu">nrow</span>(inter)]<span class="sc">&amp;</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                    orchard_hours<span class="sc">$</span>Month<span class="sc">==</span>inter<span class="sc">$</span>Month[<span class="fu">nrow</span>(inter)]<span class="sc">&amp;</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                    orchard_hours<span class="sc">$</span>Day<span class="sc">==</span>inter<span class="sc">$</span>Day[<span class="fu">nrow</span>(inter)]<span class="sc">&amp;</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                    orchard_hours<span class="sc">$</span>Hour<span class="sc">==</span>inter<span class="sc">$</span>Hour[<span class="fu">nrow</span>(inter)])</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>observed<span class="ot">&lt;-</span>inter<span class="sc">$</span>Temp_recorded</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>option1<span class="ot">&lt;-</span>winters_hours<span class="sc">$</span>Temp[start_hour_winters<span class="sc">:</span>end_hour_winters]</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>option2<span class="ot">&lt;-</span>orchard_hours<span class="sc">$</span>Temp[start_hour_orchard<span class="sc">:</span>end_hour_orchard]</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>option3<span class="ot">&lt;-</span><span class="fu">interpolate_gaps</span>(inter<span class="sc">$</span>Temp_gaps)<span class="sc">$</span>interp</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>option4<span class="ot">&lt;-</span>inter<span class="sc">$</span>Temp</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>eval_table<span class="ot">&lt;-</span>eval_table_gaps<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Option=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">Input_data=</span><span class="fu">c</span>(<span class="st">&quot;daily&quot;</span>,<span class="st">&quot;daily&quot;</span>,<span class="st">&quot;hourly&quot;</span>,<span class="st">&quot;hourly&quot;</span>),</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">Interpolation_method=</span><span class="fu">c</span>(<span class="st">&quot;from proxy&quot;</span>,<span class="st">&quot;local extremes&quot;</span>,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;linear&quot;</span>,<span class="st">&quot;hourly interpolation&quot;</span>),</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">RMSEP=</span><span class="cn">NA</span>,<span class="at">RPIQ=</span><span class="cn">NA</span>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>observed_gaps<span class="ot">&lt;-</span>observed[<span class="fu">which</span>(<span class="fu">is.na</span>(inter<span class="sc">$</span>Temp_gaps))]</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>option1_gaps<span class="ot">&lt;-</span>option1[<span class="fu">which</span>(<span class="fu">is.na</span>(inter<span class="sc">$</span>Temp_gaps))]</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>option2_gaps<span class="ot">&lt;-</span>option2[<span class="fu">which</span>(<span class="fu">is.na</span>(inter<span class="sc">$</span>Temp_gaps))]</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>option3_gaps<span class="ot">&lt;-</span>option3[<span class="fu">which</span>(<span class="fu">is.na</span>(inter<span class="sc">$</span>Temp_gaps))]</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>option4_gaps<span class="ot">&lt;-</span>option4[<span class="fu">which</span>(<span class="fu">is.na</span>(inter<span class="sc">$</span>Temp_gaps))]</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>eval_table_gaps[,<span class="st">&quot;RMSEP&quot;</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">RMSEP</span>(option1_gaps,observed_gaps),</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">RMSEP</span>(option2_gaps,observed_gaps),</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">RMSEP</span>(option3_gaps,observed_gaps),</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">RMSEP</span>(option4_gaps,observed_gaps)),<span class="dv">1</span>)</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>eval_table_gaps[,<span class="st">&quot;RPIQ&quot;</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">RPIQ</span>(option1_gaps,observed_gaps),</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">RPIQ</span>(option2_gaps,observed_gaps),</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">RPIQ</span>(option3_gaps,observed_gaps),</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">RPIQ</span>(option4_gaps,observed_gaps)),<span class="dv">1</span>)</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(eval_table_gaps,<span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Option</th>
<th align="left">Input_data</th>
<th align="left">Interpolation_method</th>
<th align="right">RMSEP</th>
<th align="right">RPIQ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">daily</td>
<td align="left">from proxy</td>
<td align="right">2.5</td>
<td align="right">4.2</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">daily</td>
<td align="left">local extremes</td>
<td align="right">2.0</td>
<td align="right">5.4</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">hourly</td>
<td align="left">linear</td>
<td align="right">5.3</td>
<td align="right">2.0</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">hourly</td>
<td align="left">hourly interpolation</td>
<td align="right">1.9</td>
<td align="right">5.6</td>
</tr>
</tbody>
</table>
<p>This table shows that the <code>interpolate_gaps_hourly</code> function produced the best results, with an RMSEP of 1.9 and an RPIQ of 5.6. It’s interesting to note that option 3, where hourly records collected in the orchard were interpolated linearly, produced the worst fit. This highlights that, at least in this case, using an idealized temperature curve to close gaps in daily temperatures from the orchard (option 2) and even from the proxy station (option 1) produced more accurate results. Naturally, the quality of the latter approach will depend on the similarity between weather at the proxy station and in the orchard (in this case, this should be quite similar).</p>
<p>Restricting the comparison to only the gaps in the record is a bit unfair, because of course option 3 (linear interpolation of hourly records from the orchard) are completely accurate for hours, when temperatures were recorded. So let’s also compare the relative performance of the four methods across all hours of the record.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>eval_table<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Option=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Input_data=</span><span class="fu">c</span>(<span class="st">&quot;daily&quot;</span>,<span class="st">&quot;daily&quot;</span>,<span class="st">&quot;hourly&quot;</span>,<span class="st">&quot;hourly&quot;</span>),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Interpolation_method=</span><span class="fu">c</span>(<span class="st">&quot;from proxy&quot;</span>,<span class="st">&quot;local extremes&quot;</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;linear&quot;</span>,<span class="st">&quot;hourly interpolation&quot;</span>),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">RMSEP=</span><span class="cn">NA</span>,<span class="at">RPIQ=</span><span class="cn">NA</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>eval_table[,<span class="st">&quot;RMSEP&quot;</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">RMSEP</span>(option1,observed),<span class="fu">RMSEP</span>(option2,observed),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">RMSEP</span>(option3,observed),<span class="fu">RMSEP</span>(option4,observed)),<span class="dv">1</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>eval_table[,<span class="st">&quot;RPIQ&quot;</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">RPIQ</span>(option1,observed),<span class="fu">RPIQ</span>(option2,observed),</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">RPIQ</span>(option3,observed),<span class="fu">RPIQ</span>(option4,observed)),<span class="dv">1</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(eval_table,<span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Option</th>
<th align="left">Input_data</th>
<th align="left">Interpolation_method</th>
<th align="right">RMSEP</th>
<th align="right">RPIQ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">daily</td>
<td align="left">from proxy</td>
<td align="right">2.5</td>
<td align="right">4.3</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">daily</td>
<td align="left">local extremes</td>
<td align="right">1.8</td>
<td align="right">6.1</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">hourly</td>
<td align="left">linear</td>
<td align="right">3.9</td>
<td align="right">2.7</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">hourly</td>
<td align="left">hourly interpolation</td>
<td align="right">1.4</td>
<td align="right">7.5</td>
</tr>
</tbody>
</table>
<p>The relative performance of the methods on the whole dataset is quite similar to the previous assessment. The quality of the proxy-based idealized temperature curves went down slightly, while all other approaches saw improvements in quality (lower RMSEP and higher RPIQ). The RPIQ values for the two interpolations that were based on local data (options 2 and 4) are very high, especially for option 4, which used the <code>interpolate_gaps_hourly</code> function. The RPIQ score for this option almost exceeds the ‘excellence’ threshold for the most conservative RPIQ evaluation scheme that I’ve come across (8). I find this quite remarkable, given the variable nature of daily temperature fluctuations and the fact that about half of the actually recorded values were removed before running the interpolation.</p>
<p><strong><em>In conclusion, the <code>interpolate_gaps_hourly</code> function provided a very good approximation of hourly temperatures for times, when no values were recorded.</em></strong></p>
</div>
<div id="computing-agroclimatic-metrics" class="section level2">
<h2>Computing agroclimatic metrics</h2>
<p>Finally, let’s look at the implication of the choice of interpolation method on chill and heat estimates. If we’re interested in using the Dynamic Model for winter chill or the Growing Degree Hours model for heat, we can simply calculate this using the <code>Dynamic_Model</code> and <code>GDH</code> functions in <code>chillR</code>. For more functionality, see the <code>chilling</code> and particularly the <code>tempResponse</code> functions.</p>
<p>Let’s first look at the implications of method choice on chill accumulation:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>option1_chill<span class="ot">&lt;-</span><span class="fu">Dynamic_Model</span>(option1)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>option2_chill<span class="ot">&lt;-</span><span class="fu">Dynamic_Model</span>(option2)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>option3_chill<span class="ot">&lt;-</span><span class="fu">Dynamic_Model</span>(option3)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>option4_chill<span class="ot">&lt;-</span><span class="fu">Dynamic_Model</span>(option4)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>observed_chill<span class="ot">&lt;-</span><span class="fu">Dynamic_Model</span>(observed)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>This figure shows that the chill accumulation differed substantially between the options. Both the use of proxy data and the use of linear interpolation of hourly temperatures led to substantial overestimation of chill accumulation.</p>
<p>Here is the same assessment for heat:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>option1_heat<span class="ot">&lt;-</span><span class="fu">GDH</span>(option1)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>option2_heat<span class="ot">&lt;-</span><span class="fu">GDH</span>(option2)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>option3_heat<span class="ot">&lt;-</span><span class="fu">GDH</span>(option3)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>option4_heat<span class="ot">&lt;-</span><span class="fu">GDH</span>(option4)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>observed_heat<span class="ot">&lt;-</span><span class="fu">GDH</span>(observed)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>This comparison doesn’t look quite as bad as for chill accumulation, but also here, option 4 clearly provided the most accurate estimate (it almost coincides with the black line, making the difference hard to see).</p>
<p>This dataset didn’t cover the winter season, so the chill numbers aren’t too meaningful, but it is nevertheless instructive to compare the total accumulation of chill and heat over the whole temperature record:</p>
<table>
<thead>
<tr class="header">
<th align="right">Option</th>
<th align="left">Input_data</th>
<th align="left">Interpolation_method</th>
<th align="right">Chill Portions</th>
<th align="right">Growing Degree Hours</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="left">observed</td>
<td align="left">none</td>
<td align="right">12.2</td>
<td align="right">72925</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">daily</td>
<td align="left">from proxy</td>
<td align="right">19.9</td>
<td align="right">66837</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">daily</td>
<td align="left">local extremes</td>
<td align="right">12.9</td>
<td align="right">72547</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">hourly</td>
<td align="left">linear</td>
<td align="right">23.1</td>
<td align="right">78256</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">hourly</td>
<td align="left">hourly interpolation</td>
<td align="right">12.8</td>
<td align="right">72388</td>
</tr>
</tbody>
</table>
<p>This comparison shows that the choice of interpolation method can have substantial impact on our impression of accumulated chill and heat. The <code>interpolate_gaps_hourly</code> function in <code>chillR</code> outperformed all other methods evaluated here.</p>
<div id="references" class="section level4 unnumbered">
<h4 class="unnumbered">References</h4>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Almoroxetal2005" class="csl-entry">
Almorox, J., Hontoria, C., Benito, M., 2005. Statistical validation of daylength definitions for estimation of global solar radiation in toledo, spain. Energy Conversion and Management 46, 1465–1471. <a href="https://doi.org/10.1016/j.enconman.2004.07.007">https://doi.org/10.1016/j.enconman.2004.07.007</a>
</div>
<div id="ref-Andersonetal1986" class="csl-entry">
Anderson, J.L., Richardson, E.A., Kesner, C.D., 1986. <span class="nocase">Validation of chill unit and flower bud phenology models for ’Montmorency’ sour cherry</span>. Acta Horticulturae (ISHS) 184, 71–78. <a href="https://doi.org/10.17660/ActaHortic.1986.184.7">https://doi.org/10.17660/ActaHortic.1986.184.7</a>
</div>
<div id="ref-Bennett1949" class="csl-entry">
Bennett, J.P., 1949. <span class="nocase">Temperature and bud rest period</span>. California Agriculture 3, 9, 12. <a href="https://calag.ucanr.edu/download_pdf.cfm?article=ca.v003n11p9">https://calag.ucanr.edu/download_pdf.cfm?article=ca.v003n11p9</a>
</div>
<div id="ref-CrossaRaynaud1955" class="csl-entry">
Crossa-Raynaud, P., 1955. <span class="nocase">Effets des hivers doux sur le comportement des arbres fruitiers <span class="nocase">à</span> feuilles caduques: Observations faites en Tunisie <span class="nocase">à</span> la suite de l’hiver 1954-1955</span>. Impr. La Rapide.
</div>
<div id="ref-Erezetal1990" class="csl-entry">
Erez, A., Fishman, S., Linsley-Noakes, G.C., Allan, P., 1990. <span class="nocase">The dynamic model for rest completion in peach buds</span>. Acta Horticulturae 276, 165–174. <a href="https://doi.org/10.17660/ActaHortic.1990.276.18">https://doi.org/10.17660/ActaHortic.1990.276.18</a>
</div>
<div id="ref-Linvill1990" class="csl-entry">
Linvill, D.E., 1990. <span class="nocase">Calculating chilling hours and chill units from daily maximum and minimum temperature observations</span>. HortScience 25, 14–16.
</div>
<div id="ref-LuedelingBrown2011" class="csl-entry">
Luedeling, E., Brown, P.H., 2011. <span class="nocase">A global analysis of the comparability of winter chill models for fruit and nut trees</span>. International Journal of Biometeorology 55, 411–421. <a href="https://doi.org/10.1007/s00484-010-0352-y">https://doi.org/10.1007/s00484-010-0352-y</a>
</div>
<div id="ref-Richardsonetal1974" class="csl-entry">
Richardson, E.A., Seeley, S.D., Walker, D.R., 1974. <span class="nocase">A model for estimating the completion of rest for Redhaven and Elberta peach trees</span>. HortScience 9, 331–332.
</div>
<div id="ref-Spencer1971" class="csl-entry">
Spencer, J.W., 1971. <span class="nocase">Fourier series representation of the position of the Sun</span>. Search 2, 172.
</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
